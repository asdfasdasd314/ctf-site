import{t as j,a as p,n as q}from"../chunks/6w1StL2M.js";import{p as O,t as w,a as T,s as f,c as t,i as d,j as _,k,r as o,l as s}from"../chunks/Bm_VgG9E.js";import{e as U,s as B}from"../chunks/8TWQb_4_.js";import{i as P}from"../chunks/Cjra9w-q.js";import{p as F}from"../chunks/BYUgaS6m.js";import{g as H}from"../chunks/CqrwVcUq.js";var J=j('<div class="text-red-500 text-sm text-center"> </div>'),M=q('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),N=j(`<div class="min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-md w-full space-y-8"><div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Sign in to your account</h2></div> <form class="mt-8 space-y-6"><div class="rounded-md shadow-sm -space-y-px"><div><label for="username" class="sr-only">Username</label> <input id="username" name="username" type="text" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 focus:z-10 sm:text-sm" placeholder="Username"></div> <div><label for="password" class="sr-only">Password</label> <input id="password" name="password" type="password" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 focus:z-10 sm:text-sm" placeholder="Password"></div></div> <!> <div><button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50"><!> Sign in</button></div></form> <div class="text-center"><a href="/exercises/1/signup" class="text-emerald-600 hover:text-emerald-500">Don't have an account? Sign up</a></div></div></div>`);function Q(S,z){O(z,!0);let r=_(""),i=_(!1);async function C(e){e.preventDefault();const a=e.target,l=new FormData(a),y=l.get("username"),b=l.get("password");if(!y||!b){s(r,"Please enter both username and password");return}s(i,!0),s(r,"");try{const n=await(await fetch("/api/exercises/1/vulnerable-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:y,password:b})})).json();n.success?n.user_id&&(document.cookie="vulnerable_auth_user_id=; max-age=0;",document.cookie=`vulnerable_auth_user_id=${n.user_id};`,H("/exercises/1/dashboard")):n.err?s(r,F(n.err)):s(r,"An error occurred. Please try again.")}catch(h){s(r,"An error occurred. Please try again."),console.error("Login error:",h)}finally{s(i,!1)}}var c=N(),v=t(c),u=f(t(v),2),g=f(t(u),2);{var D=e=>{var a=J(),l=t(a,!0);o(a),w(()=>B(l,d(r))),p(e,a)};P(g,e=>{d(r)&&e(D)})}var x=f(g,2),m=t(x),A=t(m);{var L=e=>{var a=M();p(e,a)};P(A,e=>{d(i)&&e(L)})}k(),o(m),o(x),o(u),k(2),o(v),o(c),w(()=>m.disabled=d(i)),U("submit",u,C),p(S,c),T()}export{Q as component};
