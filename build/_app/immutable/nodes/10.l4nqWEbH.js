import{t as P,a as f,n as q}from"../chunks/6w1StL2M.js";import{p as O,t as w,a as T,s as v,c as o,i as c,j as _,k,r as n,l as a}from"../chunks/Bm_VgG9E.js";import{e as B,s as F}from"../chunks/8TWQb_4_.js";import{i as S}from"../chunks/Cjra9w-q.js";import{p as H}from"../chunks/BYUgaS6m.js";import{g as J}from"../chunks/CqrwVcUq.js";var L=P('<div class="text-red-500 text-sm text-center"> </div>'),M=q('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),N=P('<div class="min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-md w-full space-y-8"><div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Create your account</h2></div> <form class="mt-8 space-y-6"><div class="rounded-md shadow-sm -space-y-px"><div><label for="username" class="sr-only">Username</label> <input id="username" name="username" type="text" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 focus:z-10 sm:text-sm" placeholder="Username"></div> <div><label for="password" class="sr-only">Password</label> <input id="password" name="password" type="password" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 focus:z-10 sm:text-sm" placeholder="Password"></div></div> <!> <div><button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50"><!> Sign up</button></div></form> <div class="text-center"><a href="/exercises/1/login" class="text-emerald-600 hover:text-emerald-500">Already have an account? Sign in</a></div></div></div>');function Q(j,C){O(C,!0);let r=_(""),i=_(!1);async function z(e){e.preventDefault();const s=e.target,l=new FormData(s),b=l.get("username"),h=l.get("password");if(!b||!h){a(r,"Please enter both username and password");return}a(i,!0),a(r,"");try{const d=await fetch("/api/exercises/1/vulnerable-signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:b,password:h})}),t=await d.json();t.success?t.user_id&&(document.cookie="vulnerable_auth_user_id=; max-age=0;",document.cookie=`vulnerable_auth_user_id=${t.user_id};`,J("/exercises/1/dashboard")):t.username_taken?a(r,"Username has already been taken."):t.err?a(r,H(t.err)):(a(r,"An error occurred. Please try again."),console.error("Signup error:",d))}catch(d){a(r,"An error occurred. Please try again."),console.error("Signup error:",d)}finally{a(i,!1)}}var u=N(),g=o(u),m=v(o(g),2),x=v(o(m),2);{var A=e=>{var s=L(),l=o(s,!0);n(s),w(()=>F(l,c(r))),f(e,s)};S(x,e=>{c(r)&&e(A)})}var y=v(x,2),p=o(y),D=o(p);{var U=e=>{var s=M();f(e,s)};S(D,e=>{c(i)&&e(U)})}k(),n(p),n(y),n(m),k(2),n(g),n(u),w(()=>p.disabled=c(i)),B("submit",m,z),f(j,u),T()}export{Q as component};
